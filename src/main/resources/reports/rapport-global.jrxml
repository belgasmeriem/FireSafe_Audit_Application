<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd"
              name="rapport_audit_complet"
              pageWidth="595"
              pageHeight="842"
              orientation="Landscape"
              columnWidth="595"
              leftMargin="0"
              rightMargin="0"
              topMargin="0"
              bottomMargin="0"
              uuid="ab12ef1c-e512-4100-a9e7-ab744906a005">

    <property name="com.jaspersoft.studio.unit.height" value="px"/>

    <parameter name="etablissementNom" class="java.lang.String"/>
    <parameter name="etablissementType" class="java.lang.String"/>
    <parameter name="etablissementDescription" class="java.lang.String"/>
    <parameter name="etablissementAdresse" class="java.lang.String"/>
    <parameter name="etablissementCapacite" class="java.lang.Integer"/>
    <parameter name="etablissementEtages" class="java.lang.Integer"/>
    <parameter name="etablissementSurface" class="java.lang.Double"/>
    <parameter name="etablissementResponsable" class="java.lang.String"/>
    <parameter name="etablissementContact" class="java.lang.String"/>
    <parameter name="normeDescription" class="java.lang.String"/>
    <parameter name="auditType" class="java.lang.String"/>
    <parameter name="auditDate" class="java.util.Date"/>
    <parameter name="auditResponsable" class="java.lang.String"/>
    <parameter name="auditData" class="java.lang.String"/>
    <parameter name="nonConformites" class="net.sf.jasperreports.engine.data.JRBeanCollectionDataSource"/>
    <parameter name="preuves" class="net.sf.jasperreports.engine.data.JRBeanCollectionDataSource"/>

    <field name="code" class="java.lang.String"/>
    <field name="exigence" class="java.lang.String"/>
    <field name="categorie" class="java.lang.String"/>
    <field name="constat" class="java.lang.String"/>
    <field name="criticite" class="java.lang.String"/>
    <field name="reference" class="java.lang.String"/>
    <field name="actionCorrective" class="java.lang.String"/>
    <field name="preuveCode" class="java.lang.String"/>
    <field name="preuveImage" class="java.lang.String"/>

    <style name="TableCell" mode="Opaque">
        <box>
            <pen lineWidth="0.5" lineColor="#000000"/>
            <topPen lineWidth="0.5"/>
            <leftPen lineWidth="0.5"/>
            <bottomPen lineWidth="0.5"/>
            <rightPen lineWidth="0.5"/>
        </box>
    </style>

    <style name="TableHeader" mode="Opaque" backcolor="#CCCCCC">
        <box>
            <pen lineWidth="0.5" lineColor="#000000"/>
            <topPen lineWidth="0.5"/>
            <leftPen lineWidth="0.5"/>
            <bottomPen lineWidth="0.5"/>
            <rightPen lineWidth="0.5"/>
        </box>
    </style>

    <subDataset name="NonConformitesDataset" uuid="nonconf-dataset">
        <field name="code" class="java.lang.String"/>
        <field name="exigence" class="java.lang.String"/>
        <field name="categorie" class="java.lang.String"/>
        <field name="constat" class="java.lang.String"/>
        <field name="criticite" class="java.lang.String"/>
        <field name="reference" class="java.lang.String"/>
        <field name="actionCorrective" class="java.lang.String"/>
    </subDataset>

    <subDataset name="PreuvesDataset" uuid="preuves-dataset">
        <field name="preuveCode" class="java.lang.String"/>
        <field name="preuveImage" class="java.lang.String"/>
    </subDataset>

    <background>
        <band splitType="Stretch"/>
    </background>

    <title>
        <band height="842" splitType="Stretch">
            <property name="com.jaspersoft.studio.unit.height" value="px"/>
            <image>
                <reportElement x="0" y="0" width="595" height="842" uuid="704a4816-4160-459e-a3bd-6e69131dcaed"/>
                <imageExpression><![CDATA["C:/Users/HP/Downloads/rapport_jasper_templete (6).png"]]></imageExpression>
            </image>
            <textField pattern="dd/MM/yyyy">
                <reportElement x="330" y="680" width="246" height="71" forecolor="#C72118" uuid="080dd710-2c4a-4b84-b758-d37d9207da79"/>
                <textElement textAlignment="Center">
                    <font fontName="SansSerif" size="30" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{auditDate}]]></textFieldExpression>
            </textField>
        </band>
    </title>

    <pageHeader>
        <band height="842">
            <property name="com.jaspersoft.studio.unit.height" value="px"/>
            <printWhenExpression><![CDATA[$V{PAGE_NUMBER} == 2]]></printWhenExpression>
            <image>
                <reportElement x="0" y="0" width="595" height="842" uuid="1065ddd4-2e8a-4e95-bc7e-c5ac32093ffe"/>
                <imageExpression><![CDATA["C:/Users/HP/Downloads/rapport_jasper_templete (8).png"]]></imageExpression>
            </image>
            <staticText>
                <reportElement x="47" y="140" width="500" height="40" forecolor="#D6271E" uuid="73dda1c6-495c-471d-8c45-bc253d641e41"/>
                <box>
                    <pen lineWidth="0.0" lineColor="#FFFFFF"/>
                </box>
                <textElement>
                    <font fontName="Arial Black" size="12"/>
                </textElement>
                <text><![CDATA[Ce rapport est confidentiel. Sa diffusion est strictement limitée à l'équipe d'audit, au représentant de l'entreprise auditée et aux services concernés.]]></text>
            </staticText>
            <textField isBlankWhenNull="true">
                <reportElement x="310" y="220" width="250" height="30" uuid="tf1"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{etablissementNom}]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="310" y="265" width="250" height="30" uuid="tf2"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{etablissementType}]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="310" y="310" width="250" height="30" uuid="tf3"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{etablissementDescription}]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="310" y="350" width="230" height="34" uuid="tf4"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{etablissementAdresse}]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="310" y="400" width="100" height="30" uuid="tf5"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{etablissementCapacite}]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="310" y="445" width="100" height="30" uuid="tf6"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{etablissementEtages}]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="310" y="490" width="100" height="30" uuid="tf7"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{etablissementSurface} != null ? $P{etablissementSurface} + " m²" : ""]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="310" y="535" width="220" height="34" uuid="tf8"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{etablissementResponsable}]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="310" y="570" width="250" height="40" uuid="tf9"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{etablissementContact}]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="60" y="700" width="480" height="30" uuid="tf10"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{normeDescription}]]></textFieldExpression>
            </textField>
        </band>
    </pageHeader>

    <columnHeader>
        <band height="842">
            <printWhenExpression><![CDATA[$V{PAGE_NUMBER} == 3]]></printWhenExpression>
            <image>
                <reportElement x="0" y="0" width="595" height="842" uuid="img3"/>
                <imageExpression><![CDATA["C:/Users/HP/Downloads/rapport_jasper_templete (9).png"]]></imageExpression>
            </image>
            <textField isBlankWhenNull="true">
                <reportElement x="270" y="130" width="270" height="30" uuid="tf11"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{auditType}]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="270" y="185" width="270" height="30" uuid="tf12"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{auditData}]]></textFieldExpression>
            </textField>
            <textField isBlankWhenNull="true">
                <reportElement x="270" y="240" width="270" height="30" uuid="tf13"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{auditResponsable}]]></textFieldExpression>
            </textField>
            <textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
                <reportElement x="270" y="350" width="190" height="30" forecolor="#050505" uuid="tf14"/>
                <textElement><font size="12"/></textElement>
                <textFieldExpression><![CDATA[$P{auditDate}]]></textFieldExpression>
            </textField>
        </band>
    </columnHeader>

    <detail>
        <band height="100" splitType="Stretch">
            <printWhenExpression><![CDATA[$V{PAGE_NUMBER} == 4]]></printWhenExpression>
            <textField isStretchWithOverflow="true">
                <reportElement x="15" y="5" width="60" height="90" style="TableCell" uuid="d1"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{code}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true">
                <reportElement x="75" y="5" width="80" height="90" style="TableCell" uuid="d2"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font size="7"/>
                    <paragraph leftIndent="3"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{exigence}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true">
                <reportElement x="155" y="5" width="60" height="90" style="TableCell" uuid="d3"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="7"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{categorie}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true">
                <reportElement x="215" y="5" width="100" height="90" style="TableCell" uuid="d4"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font size="7"/>
                    <paragraph leftIndent="3"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{constat}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true">
                <reportElement x="315" y="5" width="65" height="90" style="TableCell" uuid="d5"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="7"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{criticite}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true">
                <reportElement x="380" y="5" width="60" height="90" style="TableCell" uuid="d6"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="7"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{reference}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true">
                <reportElement x="440" y="5" width="140" height="90" style="TableCell" uuid="d7"/>
                <textElement textAlignment="Left" verticalAlignment="Middle">
                    <font size="7"/>
                    <paragraph leftIndent="3"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{actionCorrective}]]></textFieldExpression>
            </textField>
        </band>
    </detail>

    <summary>
        <band height="2526">
            <image>
                <reportElement x="0" y="0" width="595" height="842" uuid="bg4"/>
                <imageExpression><![CDATA["C:/Users/HP/Downloads/background (2).png"]]></imageExpression>
            </image>

            <subreport>
                <reportElement x="10" y="120" width="575" height="700" uuid="sub1"/>
                <dataSourceExpression><![CDATA[$P{nonConformites}]]></dataSourceExpression>
                <subreportExpression><![CDATA["nonconformites_subreport.jasper"]]></subreportExpression>
            </subreport>

            <break>
                <reportElement x="0" y="841" width="100" height="1" uuid="br1"/>
            </break>

            <image>
                <reportElement x="0" y="842" width="595" height="842" uuid="bg5"/>
                <imageExpression><![CDATA["C:/Users/HP/Downloads/background (3).png"]]></imageExpression>
            </image>

            <subreport>
                <reportElement x="10" y="962" width="575" height="700" uuid="sub2"/>
                <dataSourceExpression><![CDATA[$P{preuves}]]></dataSourceExpression>
                <subreportExpression><![CDATA["preuves_subreport.jasper"]]></subreportExpression>
            </subreport>

            <break>
                <reportElement x="0" y="1683" width="100" height="1" uuid="br2"/>
            </break>

            <image>
                <reportElement x="0" y="1684" width="595" height="842" uuid="bg6"/>
                <imageExpression><![CDATA["C:/Users/HP/Downloads/rapport_jasper_templete (4).png"]]></imageExpression>
            </image>

            <break>
                <reportElement x="0" y="2525" width="100" height="1" uuid="br3"/>
            </break>
        </band>
    </summary>

    <lastPageFooter>
        <band height="842">
            <image>
                <reportElement x="0" y="0" width="595" height="842" uuid="bg8"/>
                <imageExpression><![CDATA["C:/Users/HP/Downloads/background (4).png"]]></imageExpression>
            </image>
        </band>
    </lastPageFooter>

</jasperReport>